/*! JtControls v0.1.10 | (c) 2023 Jonathan Krauss | BSD-3-Clause License | git+https://github.com/asymworks/jadetree-ui.git */
!function(){"use strict";"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var t={};({get exports(){return t},set exports(s){t=s}}).exports=function(){var t={length:32,template:"%qinu%",dict:"1234567890abcdefghijklmnopqrstuvwxyz",random:!1},s=function(t,i){if(!t.length)return"";var e=i.indexOf(t.slice(-1));return e+1<i.length?t.slice(0,-1)+i[e+1]:s(t.slice(0,-1),i)+i[0]},i=function(t,s,e){if(void 0===e&&(e=""),e.length>=s)return e;var h=t[Math.floor(Math.random()*t.length)];return i(t,s,e+h)},e=function(t,s,i){return i.reduce((function(t,s,i){return t.replace(new RegExp("%arg\\["+i+"\\]%","g"),s)}),t.replace(/%qinu%/g,s))},h=function(s){return s||0===s?"object"!=typeof s&&(s={length:+s}):s={},(s=Object.assign({},t,s)).dict&&(s.dict=s.dict.split("").sort().filter((function(t,s,i){return i[s-1]!==t})).join("")),s},n=function(){};function a(t,s){var a=this instanceof n?t:h(t),r=a.dict,o=a.length,l=a.template,c=a.args,u=a.random;s instanceof Array||(s=Array.prototype.slice.call(arguments,1)),c instanceof Array&&(s=c.concat(s));var d=!u&&this instanceof n?this.next(r,o):i(r,o);return e(l,d,s)}return n.prototype.next=function(t,e){var h=this.key||i(t,e);return this.key=s(h,t),this.key},a.create=function(t){return a.bind(new n,h(t))},a}();const s=t.create({length:6,template:"%arg[0]%-%qinu%"}),i=function(){if(!window.DOMParser)return!1;try{(new DOMParser).parseFromString("x","text/html")}catch(t){return!1}return!0}();function e(t){if(i){const s=(new DOMParser).parseFromString(t,"text/html");return s.body.firstElementChild instanceof Element?s.body.firstElementChild:s.body}const s=document.createElement("div");return s.innerHTML=t,s.firstElementChild instanceof Element?s.firstElementChild:s}function h(t,s){let i=t.nextElementSibling;for(;i;){if(s(i))return i;i=i.nextElementSibling}return i}function n(t,s,i){var e;return!(!t||!t.hasAttribute(s))&&(!(null==i?void 0:i.aria)&&!s.toLowerCase().startsWith("aria-")||"true"===(null===(e=t.getAttribute(s))||void 0===e?void 0:e.toLowerCase()))}class a{[Symbol.iterator](){return this.values()}get length(){return this.t.length}get value(){return this.t.join(" ")}set value(t){if(t){const s=(t||"").split(" ").map((t=>t.trim())),i=s.filter((t=>!this.t.includes(t))),e=this.t.filter((t=>!s.includes(t)));i.length>0&&this.i("add",...i),e.length>0&&this.i("remove",...e)}else this.t.length>0&&this.i("remove",...this.t),this.t=[]}add(...t){const s=t.filter((t=>!this.t.includes(t)));s.length>0&&(this.t.push(...s),this.i("add",...s))}contains(t){return this.t.includes(t)}entries(){return this.t.entries()}forEach(t,s){const i=t.bind(s);for(const[t,s]of this.entries())i(s,t,this)}item(t){return t<0||t>=this.length?null:this.t.at(t)}keys(){return this.t.keys()}remove(...t){const s=t.filter((t=>this.t.includes(t)));s.length>0&&(this.t=this.t.filter((t=>!s.includes(t))),this.i("remove",...s))}replace(t,s){const i=this.t.indexOf(t);if(-1===i)return!1;this.t[i]=s,this.i("remove",t),this.i("add",s)}supports(t){return!0}toggle(t,s){return this.contains(t)||void 0!==s&&!s?!this.contains(t)||void 0!==s&&s||this.remove(t):this.add(t),this.contains(t)}values(){return this.t.values()}constructor(t,s){this.i=t,this.t=s||[]}}const r=t=>s(`${t}-item`),o=t=>t.searchRegex&&t.label&&!t.empty?t.label.replace(t.searchRegex,"<mark>$&</mark>"):t.creating?`Press enter to create <mark>${t.searchString}</mark>`:t.empty?t.searchString||t.label?"No Items Found":"No Items":t.label||"",l=t=>t.label||"",c={canSelect:!0,cursorTimeout:150,filterRegex:t=>new RegExp(`\\b(${t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"i"),pageSize:10,type:"single"};class u{h(){if(!this.o)return;const t=this.l.querySelector(`#${this.o}`);if(t){const s=this.l.getBoundingClientRect(),{top:i,bottom:e}=t.getBoundingClientRect();(i<s.top||e>s.bottom)&&t.scrollIntoView({behavior:"smooth",block:"nearest"})}}u(t){const s=`<ul class="jt-listbox" role="listbox" id="${this.p}" data-type="${this.m.type}"></ul>`;if(this.l=e(s),this.l.classList.add(...this.g.values()),"number"==typeof this.m.tabIndex&&this.l.setAttribute("tabindex",`${this.m.tabIndex}`),t instanceof HTMLElement)for(const s of t.children)if(s instanceof HTMLOptionElement||s instanceof HTMLOptGroupElement){if("placeholder"===s.dataset.role)continue;this.add(s)}else 3!==s.nodeType&&console.warn(`Unexpected element ${s.nodeName.toLowerCase()} in <${t.nodeName.toLowerCase()}>`);else Array.isArray(t)?t.forEach((t=>this.add(t))):console.error(`Unexpected type "${typeof t}" provided to _createDom`,t);const i=e(`<li class="jt-listbox__item" id="${this.p}-empty" data-empty="true" aria-hidden="true" hidden="true"></li>`);return i.classList.add(...this.v.values()),this.m.canCreate?i.setAttribute("role","option"):i.setAttribute("role","presentation"),this._(i),this.l.append(i),this.$(),this.l}L(t,s=!1){const i=t.key?t.key:r(this.p);document.querySelector(`#${i}`)&&!s&&console.error(`An element with key ${i} already exists.`);const{label:h,group:n,disabled:a,data:o}=t;h||console.warn("Label for <optgroup> is empty");const l=e(`\n<li class="jt-listbox__group" id="${i}">\n    <ul role="group" aria-labelledby="${i}-hdr">\n        <li role="presentation" class="jt-listbox__item jt-listbox__item--header" data-label="${h}" id="${i}-hdr"></li>\n    </ul>\n</li>`);l.classList.add(...this.k.values()),Object.keys(o||{}).length&&(l.dataset.itemData=JSON.stringify(o)),a&&l.setAttribute("aria-disabled","true");const c=l.querySelector('ul[role="group"]');if(!c)throw new Error("_createGroup did not render a ul[role=group]");const u=l.querySelector("li[role=presentation]");if(u.classList.add(...this.T.values()),!u)throw new Error("_createGroup did not render a li[role=presentation]");return u.dataset.groupId=i,u.dataset.itemData=JSON.stringify(o),this._(u),null==n||n.forEach((t=>{t.group?console.error("Nested option groups are not allowed"):c.append(this.C(t))})),l}C(t,s=!1){const i=t.key?t.key:r(this.p);document.querySelector(`#${i}`)&&!s&&console.error(`An element with key ${i} already exists.`);const{label:h,value:n,disabled:a,separator:o,data:l}=t;if(o){const t=e(`<li class="jt-listbox__item" id="${i}" role="separator"></li>`);return t.classList.add(...this.v.values()),t.dataset.itemData=JSON.stringify(l),this._(t),t}h||n||console.warn("Neither label nor value was specified for <option>"),this.l.querySelector(`[data-value="${n||h}"]`)&&!s&&console.warn(`An element with value ${n||h} already exists.`);const c=e(`<li class="jt-listbox__item" id="${i}" data-value="${n||h}" data-label="${h||n}" role="option"></li>`);return c.classList.add(...this.v.values()),Object.keys(l||{}).length&&(c.dataset.itemData=JSON.stringify(l)),l&&l.searchLabel&&(c.dataset.searchLabel=l.searchLabel),a&&c.setAttribute("aria-disabled","true"),this._(c),c}j(t){this.M=!0,this.H(),this.O(t),this.h(),setTimeout((()=>{this.M=!1}),this.m.cursorTimeout)}A(t){if(!t||!this.I(t))return;this.D=this.D.filter((s=>s!==t));const s=this.l.querySelector(`#${t}`);s&&s.removeAttribute("aria-checked")}S(t){for(const s of t){let t=s.target;if("characterData"===s.type&&(t=s.target.parentElement),!(t instanceof HTMLElement))return;if(t.getAttribute("data-jt-list-box")===this.p){for(const t of s.addedNodes)if(t instanceof HTMLOptGroupElement||t instanceof HTMLOptionElement){const s=h(t,(t=>t instanceof HTMLElement&&t.hasAttribute("data-key")));s instanceof HTMLElement?this.add(t,s.dataset.key):this.add(t,null)}for(const t of s.removedNodes)t instanceof HTMLElement&&t.hasAttribute("data-key")&&this.remove(t.dataset.key)}else if(s.target instanceof HTMLOptionElement||s.target instanceof HTMLOptGroupElement){const i=t.getAttribute("data-key");if(!i)continue;const e=this.l.querySelector(`#${i}`);if(!e)continue;const h=this.F(s.target,!1),n=s.target instanceof HTMLOptGroupElement?this.L(h,!0):this.C(h,!0);this.l.replaceChild(n,e),n.id=i}}}F(t,s=!0){var i;const e=t.disabled,h=t.dataset.key?t.dataset.key:r(this.p);if(s&&this.U&&(t.dataset.key=h,this.U.observe(t,{attributes:!0,characterData:"OPTION"===t.nodeName,childList:"OPTGROUP"===t.nodeName,subtree:!1})),t instanceof HTMLOptGroupElement){return{key:h,label:t.dataset.label?t.dataset.label:t.label.trim(),group:Array.from(t.querySelectorAll("option")).map((t=>this.F(t,s))).filter((t=>null!==t)),disabled:e,data:t.dataset}}if("separator"===t.dataset.role){return{key:h,disabled:e,separator:!0,data:(({key:t,label:s,role:i,...e})=>e)(t.dataset)}}{const s=t.value,a=t.dataset.label?t.dataset.label:t.label?t.label:(null===(i=t.textContent)||void 0===i?void 0:i.trim())||"",r=(({key:t,label:s,role:i,...e})=>e||{})(t.dataset);return{key:h,label:a||s,value:s||a,disabled:e,selected:n(t,"selected"),data:r}}}N(t){return"option"===t.getAttribute("role")&&!n(t,"aria-disabled")}I(t){return-1!==this.D.indexOf(t)}P(t){const s=this.l.querySelector(`#${t}`);if(s instanceof HTMLElement)return s.dataset.label}G(t){const s=t.target;if(s&&s instanceof HTMLElement&&this.N(s)){const i=new CustomEvent("item:click",{bubbles:!0,detail:{mouseEvent:t,value:s.dataset.value}});this.l.dispatchEvent(i)}}R(t){const s=t.target;s&&s instanceof HTMLElement&&this.N(s)&&!this.M&&(this.O(),this.H(s.id))}B(t){const s=t.target;s&&s instanceof HTMLElement&&s.matches(".jt-hover")&&!this.M&&(this.O(),this.H())}J(t){var s;const i={key:t.id||"",value:t.dataset.value,label:t.dataset.label,groupLabel:t.dataset.groupLabel,searchRegex:this.K||void 0,searchString:this.q||void 0,type:this.m.type||"single",data:{}};try{i.data=JSON.parse(t.dataset.itemData||"{}")}catch(t){}const e=null===(s=t.getAttribute("role"))||void 0===s?void 0:s.toLowerCase();return"option"===e?(i.disabled=n(t,"aria-disabled"),i.focused=this.o===t.id):"separator"===e?i.separator=!0:"true"===t.dataset.empty&&(i.creating=this.m.canCreate,i.empty=!0),i}_(t){var s;let i;const e=this.J(t),h=null===(s=t.getAttribute("role"))||void 0===s?void 0:s.toLowerCase();"option"===h||"separator"===h||"true"===t.dataset.empty?i=this.V||o:"presentation"===h&&(i=this.W||l),i?t.innerHTML=i(e):t.textContent=e.label||""}X(t){if(t&&!this.I(t))if("multiple"===this.m.type){const s=this.l.querySelector(`#${t}`);s instanceof HTMLElement&&(this.D.push(t),s.setAttribute("aria-checked","true"))}else if("single"===this.m.type)if(this.l.querySelectorAll("[role=option]").forEach((t=>{t.removeAttribute("aria-checked"),t.removeAttribute("aria-selected")})),null===t)this.D=[];else{const s=this.l.querySelector(`#${t}`);s&&(this.D=[t],s.setAttribute("aria-selected","true"))}}O(t){const s=this.l.querySelector(".jt-focused"),i=t?this.l.querySelector(`#${t}`):null;t&&s&&s.id===t||(s&&(s.dispatchEvent(new FocusEvent("item:focusout",{bubbles:!0,relatedTarget:i})),s.classList.remove("jt-focused"),this.o="",this._(s)),i instanceof HTMLElement&&this.N(i)&&(i.classList.add("jt-focused"),i.dispatchEvent(new FocusEvent("item:focusin",{bubbles:!0,relatedTarget:s})),this.o=t,this._(i)))}H(t){const s=this.l.querySelector(".jt-hover"),i=t?this.l.querySelector(`#${t}`):null;t&&s&&s.id===t||(s&&(s.classList.remove("jt-hover"),this.Y="",this._(s)),i instanceof HTMLElement&&this.N(i)&&(i.classList.add("jt-hover"),this.Y=t,this._(i)))}$(){let t=!1;this.l.querySelectorAll("[role=option]").forEach((s=>{if(!(s instanceof HTMLElement))return;const i=s.dataset.searchLabel?s.dataset.searchLabel:s.dataset.label;i&&this.q&&null===i.match(this.K)?(s.setAttribute("aria-hidden","true"),s.setAttribute("hidden","true")):(s.removeAttribute("aria-hidden"),s.removeAttribute("hidden"),t=!0),this._(s)}));const s=t=>"option"===t.getAttribute("role")&&!n(t,"hidden")&&!n(t,"aria-hidden");this.l.querySelectorAll("[role=separator]").forEach((function(t){h(t,s)&&function(t,s){let i=t.previousElementSibling;for(;i;){if(s(i))return i;i=i.previousElementSibling}return i}(t,s)?(t.removeAttribute("aria-hidden"),t.removeAttribute("hidden")):(t.setAttribute("aria-hidden","true"),t.setAttribute("hidden","true"))})),this.l.querySelectorAll("[role=presentation]").forEach((t=>{if(!(t instanceof HTMLElement))return;const i=t.closest(".jt-listbox__group");i&&(h(t,s)?(i.removeAttribute("aria-hidden"),i.removeAttribute("hidden")):(i.setAttribute("aria-hidden","true"),i.setAttribute("hidden","true")),this._(t))}));const i=this.l.querySelector(`#${this.p}-empty`);i instanceof HTMLElement&&(t?(i.setAttribute("aria-hidden","true"),i.setAttribute("hidden","true")):(i.removeAttribute("aria-hidden"),i.removeAttribute("hidden")),this._(i))}Z(t,s,...i){"list"===t?this.l.classList[s](...i):"group"===t?this.l.querySelectorAll('[role="group"]').forEach((t=>t.classList[s](...i))):"header"===t?this.l.querySelectorAll('[role="group"] [role="presentation"]').forEach((t=>t.classList[s](...i))):"item"===t&&this.l.querySelectorAll(".jt-listbox__item").forEach((t=>t.classList[s](...i)))}tt(t){const s=this.l.querySelector(`#${t}`);if(s instanceof HTMLElement)return s.dataset.value}st(){return this.l?Array.from(this.l.querySelectorAll("[role=option]")).filter((t=>!n(t,"aria-hidden")&&!n(t,"aria-disabled"))).filter((t=>!this.m.hideSelected||!this.I(t.id))).map((t=>t.id)):[]}add(t,s){let i,e=null;if("number"==typeof s){const t=Array.from(this.l.querySelectorAll("[role=option]"));s>0&&s<t.length&&(e=t[s])}else"string"==typeof s&&(e=this.l.querySelector(`#${s}`));const h=t instanceof HTMLElement?this.F(t):"object"==typeof t?t:{label:t};return h?(i=h.group?this.L(h):this.C(h),i?(e?e.insertAdjacentElement("beforebegin",i):this.l.append(i),h.selected&&("multiple"!==this.m.type&&""!==this.value&&console.warn(`Multiple selected options provided to ${this.p}`),this.X(i.id)),i):null):null}clear(){this.D=[],this.l.querySelectorAll("[role=option]").forEach((t=>{t.removeAttribute("aria-checked"),t.removeAttribute("aria-selected")}))}deselect(t){this.l.querySelectorAll(`[data-value="${t}"]`).forEach((t=>this.A(t.id)))}disconnect(){this.U&&this.U.disconnect();const t=document.querySelector(`[data-jt-list-box="${this.p}"]`);t&&t.removeAttribute("data-jt-list-box"),document.querySelectorAll(`option[data-key^="${this.p}"]`).forEach((t=>t.removeAttribute("data-key")))}focusClear(){this.H(),this.O()}focusDown(){const t=this.st(),s=t.indexOf(this.o||this.Y);s<t.length-1&&this.j(t[s+1])}focusEnd(){const t=this.st();t.length>0&&this.j(t[t.length-1])}focusHome(){const t=this.st();t.length>0&&this.j(t[0])}focusPageDown(){const t=this.st(),s=t.indexOf(this.o||this.Y);if(t.length>0){const i=Math.min(s+(this.m.pageSize||10),t.length-1);this.j(t[i])}}focusPageUp(){const t=this.st(),s=-1===t.indexOf(this.o||this.Y)?t.length:t.indexOf(this.o||this.Y);if(t.length>0){const i=Math.max(s-(this.m.pageSize||10),0);this.j(t[i])}}focusSelected(){0===this.D.length?this.focusHome():this.j(this.D[0])}focusTypeahead(t){if(!t)return;const s=t.toLowerCase(),i=this.st().map((t=>{var s;return[t,null===(s=this.P(t))||void 0===s?void 0:s.toLowerCase()]})).filter((t=>"string"==typeof t[1]&&t[1].startsWith(s)));if(!i.length)return void this.O();const e=i.findIndex((([t,s])=>t===this.o));e>=i.length-1?this.j(i[0][0]):this.j(i[e+1][0])}focusUp(){const t=this.st(),s=t.indexOf(this.o||this.Y);-1===s?this.j(t[t.length-1]):s>0&&this.j(t[s-1])}focusValue(t){const s=this.l.querySelector(`[data-value="${t}"]`);return!!(s&&s instanceof HTMLElement&&this.N(s))&&(this.j(s.id),!0)}item(t){let s=null;if("number"==typeof t){const i=Array.from(this.l.querySelectorAll("[role=option]"));t>0&&t<i.length&&(s=i[t])}else"string"==typeof t&&(s=this.l.querySelector(`#${t}`));return s instanceof HTMLLIElement?this.J(s):null}itemByValue(t){const s=document.querySelector(`[data-value="${t}"]`);return s instanceof HTMLLIElement?this.J(s):null}remove(t){let s=null;if("number"==typeof t){const i=Array.from(this.l.querySelectorAll("[role=option]"));t>0&&t<i.length&&(s=i[t])}else"string"==typeof t&&(s=this.l.querySelector(`#${t}`));s&&this.l.removeChild(s)}select(t){this.l.querySelectorAll(`[data-value="${t}"]`).forEach((t=>this.X(t.id)))}toggle(t){this.l.querySelectorAll(`[data-value="${t}"]`).forEach((t=>this.I(t.id)?this.A(t.id):this.X(t.id)))}get displayText(){const t=this.D.map((t=>this.P(t))).filter((t=>!!t));return"multiple"===this.m.type?t:"single"===this.m.type&&t.length?t[0]:""}get empty(){return 0===this.st().length}get filter(){return this.q}set filter(t){this.q=t,this.q?this.m.filterRegex?this.K=this.m.filterRegex(t):this.K=new RegExp(`\\b(${t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"i"):this.K=null,this.$()}get focusedId(){return this.o||this.Y}get focusedValue(){if(!this.o||this.Y)return"";const t=this.l.querySelector(`#${this.o||this.Y}`);return t&&t.dataset.value?t.dataset.value:""}get groupClassList(){return this.k}get headerClassList(){return this.T}get headerTemplate(){return this.W}set headerTemplate(t){this.W=t,this.$()}get listClassList(){return this.g}get itemClassList(){return this.v}get itemTemplate(){return this.V}set itemTemplate(t){this.V=t,this.$()}get root(){return this.l}get value(){const t=this.D.map((t=>this.tt(t))).filter((t=>!!t));return"multiple"===this.m.type?t:"single"===this.m.type&&t.length?t[0]:""}set value(t){if(this.clear(),"multiple"===this.m.type)Array.isArray(t)?t.forEach((t=>{this.select(t)})):this.select(t);else if("single"===this.m.type){if(Array.isArray(t))throw new Error("Cannot select multiple items");this.select(t)}}constructor(t,s,i){this.it=!1,this.M=!1,this.q="",this.o="",this.Y="",this.p="",this.K=null,this.D=[],this.p=t,this.m=Object.assign({},c,i||{}),this.k=new a(((t,...s)=>this.Z("group",t,...s)),this.m.groupListClasses||[]),this.T=new a(((t,...s)=>this.Z("header",t,...s)),this.m.groupHeaderClasses||[]),this.v=new a(((t,...s)=>this.Z("item",t,...s)),this.m.itemClasses||[]),this.g=new a(((t,...s)=>this.Z("list",t,...s)),this.m.listClasses||[]),this.W=this.m.groupHeaderTemplate||null,this.V=this.m.itemTemplate||null,this.U=new MutationObserver((t=>this.S(t))),s instanceof HTMLElement&&(s.dataset.jtListBox=this.p,this.U.observe(s,{childList:!0})),this.l=this.u(s),this.l.addEventListener("click",(t=>this.G(t)),{capture:!0}),this.l.addEventListener("pointerenter",(t=>this.R(t)),{capture:!0}),this.l.addEventListener("pointerleave",(t=>this.B(t)),{capture:!0})}}function d(t,s){const i=Object.keys(s),e=Object.values(s);return new Function(...i,`return \`${t}\`;`)(...e)}const p=["text","search","url","tel","email"];class m extends HTMLElement{get disabled(){var t;return!!(null===(t=this.et)||void 0===t?void 0:t.disabled)}set disabled(t){t?(this.setAttribute("aria-disabled","true"),this.setAttribute("disabled","")):(this.removeAttribute("aria-disabled"),this.removeAttribute("disabled")),this.ht.disabled=t,this.nt&&(this.nt.disabled=t),this.et.disabled!=t&&(this.et.disabled=t)}get groupClass(){return this.getAttribute("groupclass")}set groupClass(t){this.setAttribute("groupclass",t)}get groupClassList(){return this.rt.groupClassList}get headerClass(){return this.getAttribute("headerclass")}set headerClass(t){this.setAttribute("headerclass",t)}get headerClassList(){return this.rt.headerClassList}get headerTemplate(){return this.W}set headerTemplate(t){"function"==typeof t?(this.setAttribute("headertemplate","function"),this.W=t,this.rt.headerTemplate=t):"string"==typeof t?this.setAttribute("headertemplate",t):t||this.removeAttribute("headertemplate")}get itemClass(){return this.getAttribute("itemclass")}set itemClass(t){this.setAttribute("itemclass",t)}get itemClassList(){return this.rt.itemClassList}get itemTemplate(){return this.V}set itemTemplate(t){"function"==typeof t?(this.setAttribute("itemtemplate","function"),this.V=t,this.rt.itemTemplate=t):"string"==typeof t?this.setAttribute("itemtemplate",t):t||this.removeAttribute("itemtemplate")}get listClass(){return this.getAttribute("listclass")}set listClass(t){this.setAttribute("listclass",t)}get listClassList(){return this.rt.listClassList}get open(){return n(this.et,"aria-expanded")}set open(t){t&&!this.disabled?this.ot():this.lt()}get readOnly(){return this.et.readOnly}set readOnly(t){t?(this.setAttribute("aria-readonly","true"),this.setAttribute("readonly","")):(this.removeAttribute("aria-readonly"),this.removeAttribute("readonly")),this.et.readOnly!=t&&(this.et.readOnly=t)}ct(){if(!this.ut&&this.dt)if("#"==this.dt[0]){const t=document.querySelector(this.dt);t instanceof HTMLElement&&this.ft(t)}else fetch(this.dt).then((t=>t.json())).then((t=>this.ft(t))).catch((t=>{throw new Error(t)}))}lt(){this.classList.remove("jt-open"),this.et.setAttribute("aria-expanded","false"),this.ht.setAttribute("aria-expanded","false"),this.rt.focusClear(),this.rt.filter=""}bt(t){for(const s of t)switch(s.attributeName){case"disabled":this.disabled=this.et.disabled;break;case"readonly":this.readOnly=this.et.readOnly;break;case"list":if(this.et.hasAttribute("list")){this.lt(),this.ut=!1,this.dt=`#${this.et.getAttribute("list")}`,this.et.removeAttribute("list");break}}}gt(){this.yt=!1,this.vt=!1,this.et.parentElement.classList.remove("jt-focus"),this.rt.root.classList.remove("jt-focus")}_t(){this.yt=!0,this.vt=!1,this.et.parentElement.classList.remove("jt-focus"),this.rt.root.classList.add("jt-focus")}wt(){this.yt=!1,this.vt=!0,this.et.parentElement.classList.add("jt-focus"),this.rt.root.classList.remove("jt-focus")}$t(){return{groupListClasses:this.groupClass?[...this.groupClass.split(" ")]:[],groupHeaderClasses:this.headerClass?[...this.headerClass.split(" ")]:[],itemClasses:this.itemClass?[...this.itemClass.split(" ")]:[],listClasses:this.listClass?[...this.listClass.split(" ")]:[],groupHeaderTemplate:this.W,itemTemplate:this.V,type:"single"}}Lt(t){if(!t)return null;if(t.includes("${"))return s=>d(t,{item:s});try{const s=document.querySelector(`#${t}`);if(s instanceof HTMLElement)return t=>d(s.innerHTML,{item:t})}catch(t){}return null}G(){this.disabled||this.readOnly||(this.open=!this.open)}Et(t){const s=t.target;s instanceof HTMLElement&&null===s.closest(`#${this.p}`)&&this.lt()}kt(){this.wt()}Tt(){this.gt()}Ct(t){this.readOnly||this.jt(t.detail.value),this.lt()}xt(t){this.et.setAttribute("aria-activedescendant",t.target instanceof HTMLElement&&t.target.id||"")}Mt(t){t.relatedTarget instanceof HTMLElement?this.et.setAttribute("aria-activedescendant",t.relatedTarget.id||""):this.et.setAttribute("aria-activedescendant","")}Ht(t){let s=!1;const i=this.yt;switch(t.key){case"Enter":this.yt&&this.rt.focusedId?(this.jt(this.rt.focusedValue),this.lt(),this.wt(),s=!0):this.open&&(this.lt(),this.wt(),s=!0);break;case"Esc":case"Escape":this.open?(this.lt(),this.wt()):this.jt(""),s=!0;break;case"ArrowDown":case"Down":this.ot(),this._t(),t.altKey||this.rt.focusedId&&!i||this.rt.focusDown(),s=!0;break;case"ArrowUp":case"Up":this.rt.empty||(this.ot(),this._t(),t.altKey||this.rt.focusedId&&!i||this.rt.focusUp()),s=!0;break;case"Tab":""!==this.rt.focusedId&&this.jt(this.rt.focusedValue),this.lt()}s&&(t.stopPropagation(),t.preventDefault())}Ot(t){let s=!1;if(1===t.key.length&&t.key.match(/\S| /))this.rt.filter=this.et.value;else if("Escape"===t.key||"Esc"===t.key||"Enter"==t.key)return;switch(t.key){case"Backspace":this.wt(),this.rt.focusClear(),this.rt.filter=this.et.value,s=!0;break;case"Left":case"ArrowLeft":case"Right":case"ArrowRight":case"Home":case"End":this.wt(),this.rt.focusClear(),s=!0;break;default:this.rt.empty||(this.open||this.ot(),this.rt.focusValue(this.rt.filter)),s=!0}s&&(t.stopPropagation(),t.preventDefault())}At(){this.disabled||(this.open=!this.open)}ot(){this.ct(),this.open||(this.classList.add("jt-open"),this.et.setAttribute("aria-expanded","true"),this.ht.setAttribute("aria-expanded","true"),this.readOnly||this.rt.focusValue(this.et.value),document.activeElement!==this.et&&this.et.focus())}ft(t){const s=new u(`${this.p}-listbox`,t,this.$t());this.rt.root.replaceWith(s.root),this.rt=s,this.ut=!0,this.rt.root.addEventListener("item:click",(t=>this.Ct(t))),this.rt.root.addEventListener("item:focusin",(t=>this.xt(t))),this.rt.root.addEventListener("item:focusout",(t=>this.Mt(t)))}jt(t){this.readOnly||(this.rt.filter=t,this.et.value=t,this.et.setSelectionRange(t.length,t.length),this.et.dispatchEvent(new Event("input")))}clear(){this.jt(""),requestAnimationFrame((()=>{this.et.focus()}))}matchingItem(){return this.et.value?this.rt.itemByValue(this.et.value):null}constructor(){if(super(),this.p=this.getAttribute("id")||s("jt-autocomplete"),this.hasAttribute("id")||this.setAttribute("id",this.p),this.et=this.querySelector("input"),!this.et)return;if(!p.includes(this.et.type||"text"))throw new Error(`JtAutocomplete does not support <input type='${this.et.type}'>`);this.et.hasAttribute("autocomplete")||this.et.setAttribute("autocomplete","off"),this.et.setAttribute("role","combobox"),this.et.setAttribute("aria-autocomplete","list"),this.et.addEventListener("click",(()=>this.G())),this.et.addEventListener("focusin",(()=>this.kt())),this.et.addEventListener("focusout",(()=>this.Tt())),this.et.addEventListener("keydown",(t=>this.Ht(t))),this.et.addEventListener("keyup",(t=>this.Ot(t))),this.It=e(`<button type='button' data-action='close' id="${this.p}-close" tabindex="-1"><span class='jt-sr-only'>Close Suggestion List</span></button>`),this.It.addEventListener("click",(()=>this.lt())),this.ht=e(`<button type='button' data-action='open' id='${this.p}-open' tabindex="-1"><span class='jt-sr-only'>Show Suggestions<span></button>`),this.ht.addEventListener("click",(()=>this.At())),this.nt=e(`<button type='button' data-action='clear' id='${this.p}-clear' tabindex="-1"><span class='jt-sr-only'>Clear Input</span></button>`),this.nt.addEventListener("click",(()=>this.clear()));const t=document.createElement("div");t.classList.add("jt-control__buttons"),t.appendChild(this.ht),t.appendChild(this.nt);const i=document.createElement("div");i.classList.add("jt-control"),i.appendChild(this.It),i.appendChild(this.et),i.appendChild(t),this.appendChild(i),this.ut=!1,this.hasAttribute("src")?this.dt=this.getAttribute("src"):this.hasAttribute("list")?this.dt=`#${this.getAttribute("list")}`:this.et.hasAttribute("list")&&(this.setAttribute("list",this.et.getAttribute("list")),this.dt=`#${this.et.getAttribute("list")}`,this.et.removeAttribute("list")),this.rt=new u(`${this.p}-listbox`,[],this.$t()),this.rt.groupClassList.value=this.getAttribute("groupClass"),this.rt.headerClassList.value=this.getAttribute("headerClass"),this.rt.itemClassList.value=this.getAttribute("itemClass"),this.rt.listClassList.value=this.getAttribute("listClass");const h=document.createElement("div");h.classList.add("jt-popup"),h.appendChild(this.rt.root),this.appendChild(h),this.open=!1,this.disabled=this.et.disabled,this.readOnly=this.et.readOnly,this.classList.toggle("jt-placeholder-shown",""==this.et.value),this.et.addEventListener("input",(()=>{this.classList.toggle("jt-placeholder-shown",""==this.et.value)})),this.U=new MutationObserver((t=>this.bt(t))),this.U.observe(this.et,{attributes:!0}),document.addEventListener("click",(t=>this.Et(t)))}static get observedAttributes(){return["groupclass","headerclass","headertemplate","itemclass","itemtemplate","listclass","src"]}attributeChangedCallback(t,s,i){switch(t){case"groupclass":this.rt.groupClassList.value=i;break;case"headerclass":this.rt.headerClassList.value=i;break;case"itemclass":this.rt.itemClassList.value=i;break;case"listclass":this.rt.listClassList.value=i;break;case"headertemplate":null===i?(this.W=null,this.rt.headerTemplate=null):"function"!==i&&(this.W=this.Lt(i),this.rt.headerTemplate=this.W);break;case"itemtemplate":null===i?(this.V=null,this.rt.itemTemplate=null):"function"!==i&&(this.V=this.Lt(i),this.rt.itemTemplate=this.V);break;case"src":this.lt(),this.ut=!1,this.dt=i}}static register(){customElements.define("jt-autocomplete",m)}}m.register();class f extends HTMLElement{get disabled(){return n(this,"disabled")}set disabled(t){t?(this.setAttribute("aria-disabled","true"),this.setAttribute("disabled",""),this.Dt.setAttribute("aria-disabled","true"),this.X.setAttribute("disabled","")):(this.removeAttribute("aria-disabled"),this.removeAttribute("disabled"),this.Dt.removeAttribute("aria-disabled"),this.X.removeAttribute("disabled")),this.nt&&(this.nt.disabled=t)}get groupClass(){return this.getAttribute("groupclass")}set groupClass(t){this.setAttribute("groupclass",t)}get groupClassList(){return this.rt.groupClassList}get headerClass(){return this.getAttribute("headerclass")}set headerClass(t){this.setAttribute("headerclass",t)}get headerClassList(){return this.rt.headerClassList}get headerTemplate(){return this.W}set headerTemplate(t){"function"==typeof t?(this.setAttribute("headertemplate","function"),this.W=t,this.rt.headerTemplate=t):"string"==typeof t?this.setAttribute("headertemplate",t):t||this.removeAttribute("headertemplate")}get itemClass(){return this.getAttribute("itemclass")}set itemClass(t){this.setAttribute("itemclass",t)}get itemClassList(){return this.rt.itemClassList}get itemTemplate(){return this.V}set itemTemplate(t){"function"==typeof t?(this.setAttribute("itemtemplate","function"),this.V=t,this.rt.itemTemplate=t):"string"==typeof t?this.setAttribute("itemtemplate",t):t||this.removeAttribute("itemtemplate")}get listClass(){return this.getAttribute("listclass")}set listClass(t){this.setAttribute("listclass",t)}get listClassList(){return this.rt.listClassList}get open(){return n(this.Dt,"aria-expanded")}set open(t){t&&!this.disabled?this.ot():this.lt()}get readOnly(){return n(this,"readonly")}set readOnly(t){t?(this.setAttribute("aria-readonly","true"),this.setAttribute("readonly","")):(this.removeAttribute("aria-readonly"),this.removeAttribute("readonly"))}get searchable(){return n(this,"searchable")}set searchable(t){t?this.setAttribute("searchable",""):this.removeAttribute("searchable")}get value(){return this.rt.value}ct(){this.ut||(this.hasAttribute("src")?fetch(this.getAttribute("src")).then((t=>t.json())).then((t=>this.ft(t))).catch((t=>{throw new Error(t)})):this.ft(this.X))}lt(){this.Dt.setAttribute("aria-expanded","false"),this.rt&&this.rt.focusClear(),this.classList.remove("jt-open"),this.searchable&&(this.Dt.tabIndex=this.St,this.Ft.tabIndex=-1,this.Ft.value="",this.rt.filter="")}bt(t){for(const s of t)if("attributes"===s.type&&s.target===this.X){if("disabled"===s.attributeName)this.disabled=this.X.disabled}else"data-key"!==s.attributeName&&(console.log(s),this.hasAttribute("src")||(this.lt(),this.ut=!1))}gt(){this.yt=!1,this.Ut=!1,this.Dt.parentElement.classList.remove("jt-focus"),this.rt.root.classList.remove("jt-focus")}Nt(){this.yt=!1,this.Ut=!0,this.Dt.parentElement.classList.add("jt-focus"),this.rt.root.classList.remove("jt-focus")}_t(){this.yt=!0,this.Ut=!1,this.Dt.parentElement.classList.remove("jt-focus"),this.rt.root.classList.add("jt-focus")}$t(){return{groupListClasses:this.groupClass?[...this.groupClass.split(" ")]:[],groupHeaderClasses:this.headerClass?[...this.headerClass.split(" ")]:[],itemClasses:this.itemClass?[...this.itemClass.split(" ")]:[],listClasses:this.listClass?[...this.listClass.split(" ")]:[],groupHeaderTemplate:this.W,itemTemplate:this.V,type:"single"}}Lt(t){if(!t)return null;if(t.includes("${"))return s=>d(t,{item:s});try{const s=document.querySelector(`#${t}`);if(s instanceof HTMLElement)return t=>d(s.innerHTML,{item:t})}catch(t){}return null}Pt(){this.open||this.disabled?this.lt():this.ot()}Et(t){const s=t.target;s instanceof HTMLElement&&null===s.closest(`#${this.p}`)&&this.lt()}Gt(t){!t.isComposing&&this.searchable&&(this.rt.filter=t.target.value)}kt(){this.Nt()}Tt(){this.gt()}Ct(t){this.readOnly||this.Rt(t.detail.value),this.lt()}xt(t){this.Dt.setAttribute("aria-activedescendant",t.target instanceof HTMLElement&&t.target.id||"")}Mt(t){t.relatedTarget instanceof HTMLElement?this.Dt.setAttribute("aria-activedescendant",t.relatedTarget.id||""):this.Dt.setAttribute("aria-activedescendant","")}Ht(t){const{key:s,altKey:i,ctrlKey:e,metaKey:h,isComposing:n}=t;if(n)return;if(!this.open&&["ArrowDown","ArrowUp","Down","Enter"," ","Up"].includes(s))return this.ot(),t.stopPropagation(),void t.preventDefault();switch("Backspace"!==s&&"Clear"!==s&&(1!==s.length||" "===s||i||e||h)||(this.searchable?this.open||this.ot(!1):1===s.length&&(this.open||this.ot(!1),this.Bt(s))),s){case"ArrowDown":case"Down":return this.rt.focusDown(),t.stopPropagation(),void t.preventDefault();case"ArrowUp":case"Up":return i?(this.Jt(),this.lt()):this.rt.focusUp(),t.stopPropagation(),void t.preventDefault();case"End":return this.rt.focusEnd(),t.stopPropagation(),void t.preventDefault();case"Enter":case" ":if(" "===s&&this.searchable)return;return this.Jt(),this.lt(),t.stopPropagation(),void t.preventDefault();case"Escape":return this.lt(),t.stopPropagation(),void t.preventDefault();case"Home":return this.rt.focusHome(),t.stopPropagation(),void t.preventDefault()}}ot(t=!1){this.disabled||(this.ct(),this.Dt.setAttribute("aria-expanded","true"),this.classList.add("jt-open"),t&&this.rt&&this.rt.focusSelected(),this.searchable&&document.activeElement!==this.Ft&&(this.Dt.tabIndex=-1,this.Ft.tabIndex=this.St||0,this.Ft.focus()))}Jt(){this.rt.focusedValue&&this.Rt(this.rt.focusedValue)}Rt(t){this.disabled||this.readOnly||(this.rt.value=t,this.Kt(),this.lt(),this.dispatchEvent(new CustomEvent("change",{detail:this.value})))}ft(t){const s=new u(`${this.p}-listbox`,t,this.$t());this.rt.root.replaceWith(s.root),this.rt=s,this.ut=!0,this.rt.root.addEventListener("item:click",(t=>this.Ct(t))),this.rt.root.addEventListener("item:focusin",(t=>this.xt(t))),this.rt.root.addEventListener("item:focusout",(t=>this.Mt(t))),this.qt()}Vt(){const t=Array.from(this.X.selectedOptions).map((t=>t.value));(""===this.value&&0!==t.length||""!==this.value&&t.length>0||this.value!==t[0])&&(this.rt.value?Array.isArray(this.rt.value)?(this.X.querySelectorAll("option").forEach((t=>{t.selected=t.value&&this.rt.value.includes(t.value)})),this.X.dispatchEvent(new Event("change"))):this.rt.value!==t[0]&&(this.X.value=this.rt.value,this.X.dispatchEvent(new Event("change"))):(this.X.value="",this.X.dispatchEvent(new Event("change"))))}Bt(t){var s;"number"==typeof this.zt&&window.clearTimeout(this.zt),this.zt=window.setTimeout((()=>{this.q=""}),this.Wt||500),this.q+=t,this.q.length>1&&(s=this.q.split("")).every((t=>t===s[0]))?this.rt.focusTypeahead(this.q[0]):this.rt.focusTypeahead(this.q)}Kt(){this.rt.value?(this.Dt.innerHTML=`<span>${this.rt.displayText}</span>`,this.classList.remove("jt-placeholder-shown")):(this.Dt.innerHTML=`<span class="jt-placeholder">${this.getAttribute("placeholder")||"&nbsp;"}</span>`,this.classList.add("jt-placeholder-shown")),this.Vt()}qt(){const t=this.rt.root.scrollWidth;0==t?setTimeout((()=>this.qt()),100):this.Dt.style.width=`${t}px`}clear(){this.Rt("")}constructor(){if(super(),this.q="",this.Wt=500,this.p=this.getAttribute("id")||s("jt-select"),this.hasAttribute("id")||this.setAttribute("id",this.p),this.X=this.querySelector("select"),!this.X)return;this.St=this.X.tabIndex,this.Dt=document.createElement("div"),this.Dt.setAttribute("id",`${this.p}-control`),this.Dt.setAttribute("role","combobox"),this.Dt.setAttribute("data-role","control"),this.Dt.setAttribute("aria-controls",`${this.p}-listbox`),this.Dt.setAttribute("aria-expanded","false"),this.Dt.setAttribute("aria-haspopup","listbox"),this.Dt.setAttribute("tabindex",`${this.St}`),this.Dt.addEventListener("click",(()=>this.Pt())),this.Dt.addEventListener("focusin",(()=>this.kt())),this.Dt.addEventListener("focusout",(()=>this.Tt())),this.addEventListener("keydown",(t=>this.Ht(t)),{capture:!0}),this.It=e(`<button type='button' data-action='close' id="${this.p}-close" tabindex="-1"><span class='jt-sr-only'>Close Suggestion List</span></button>`),this.It.addEventListener("click",(()=>this.lt())),this.nt=e(`<button type='button' data-action='clear' id='${this.p}-clear' tabindex="-1"><span class='jt-sr-only'>Clear Input</span></button>`),this.nt.addEventListener("click",(()=>this.clear()));const t=document.createElement("div");t.classList.add("jt-control__buttons"),t.appendChild(this.nt);const i=document.createElement("div");i.classList.add("jt-control"),i.appendChild(this.Dt),i.appendChild(t),this.appendChild(i),this.Ft=e(`<input id="${this.p}-filter" type="search" tabindex="-1" placeholder="Search Options" />`),this.Ft.addEventListener("input",(t=>this.Gt(t)));const h=document.createElement("div");h.classList.add("jt-select__search"),h.appendChild(this.It),h.appendChild(this.Ft),this.ut=!1,this.rt=new u(`${this.p}-listbox`,[],this.$t()),this.rt.groupClassList.value=this.getAttribute("groupClass"),this.rt.headerClassList.value=this.getAttribute("headerClass"),this.rt.itemClassList.value=this.getAttribute("itemClass"),this.rt.listClassList.value=this.getAttribute("listClass");const n=document.createElement("div");if(n.classList.add("jt-popup"),n.appendChild(h),n.appendChild(this.rt.root),this.appendChild(n),this.open=!1,this.disabled=this.X.disabled,this.classList.toggle("jt-placeholder-shown",""==this.X.value),this.X.addEventListener("change",(()=>{this.classList.toggle("jt-placeholder-shown",""==this.X.value)})),this.X instanceof HTMLElement&&(document.activeElement===this.X&&this.Dt.focus(),this.X.style.display="none",this.X.id)){const t=document.querySelector(`[for="${this.X.id}"]`);t instanceof HTMLLabelElement&&(t.htmlFor=`${this.p}-control`,t.id||(t.id=`${this.p}-label`),this.Dt.setAttribute("aria-labelledby",t.id))}this.U=new MutationObserver((t=>this.bt(t))),this.U.observe(this.X,{attributes:!0,childList:!0,subtree:!0}),document.addEventListener("click",(t=>this.Et(t))),this.ct(),this.Kt(),this.qt()}static get observedAttributes(){return["groupclass","headerclass","headertemplate","itemclass","itemtemplate","listclass","src"]}attributeChangedCallback(t,s,i){switch(t){case"groupclass":this.rt.groupClassList.value=i;break;case"headerclass":this.rt.headerClassList.value=i;break;case"itemclass":this.rt.itemClassList.value=i;break;case"listclass":this.rt.listClassList.value=i;break;case"headertemplate":null===i?(this.W=null,this.rt.headerTemplate=null):"function"!==i&&(this.W=this.Lt(i),this.rt.headerTemplate=this.W);break;case"itemtemplate":null===i?(this.V=null,this.rt.itemTemplate=null):"function"!==i&&(this.V=this.Lt(i),this.rt.itemTemplate=this.V);break;case"src":this.lt(),this.ut=!1}}static register(){customElements.define("jt-select",f)}}f.register()}();
