/*! JtControls v0.1.0 | (c) 2022 Jonathan Krauss | BSD-3-Clause License | git+https://github.com/asymworks/jadetree-ui.git */
function t(t,i){var s={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&i.indexOf(e)<0&&(s[e]=t[e]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(e=Object.getOwnPropertySymbols(t);n<e.length;n++)i.indexOf(e[n])<0&&Object.prototype.propertyIsEnumerable.call(t,e[n])&&(s[e[n]]=t[e[n]])}return s}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var i={};({get exports(){return i},set exports(t){i=t}}).exports=function(){var t={length:32,template:"%qinu%",dict:"1234567890abcdefghijklmnopqrstuvwxyz",random:!1},i=function(t,s){if(!t.length)return"";var e=s.indexOf(t.slice(-1));return e+1<s.length?t.slice(0,-1)+s[e+1]:i(t.slice(0,-1),s)+s[0]},s=function(t,i,e){if(void 0===e&&(e=""),e.length>=i)return e;var n=t[Math.floor(Math.random()*t.length)];return s(t,i,e+n)},e=function(t,i,s){return s.reduce((function(t,i,s){return t.replace(new RegExp("%arg\\["+s+"\\]%","g"),i)}),t.replace(/%qinu%/g,i))},n=function(i){return i||0===i?"object"!=typeof i&&(i={length:+i}):i={},(i=Object.assign({},t,i)).dict&&(i.dict=i.dict.split("").sort().filter((function(t,i,s){return s[i-1]!==t})).join("")),i},o=function(){};function h(t,i){var h=this instanceof o?t:n(t),r=h.dict,a=h.length,l=h.template,c=h.args,u=h.random;i instanceof Array||(i=Array.prototype.slice.call(arguments,1)),c instanceof Array&&(i=c.concat(i));var d=!u&&this instanceof o?this.next(r,a):s(r,a);return e(l,d,i)}return o.prototype.next=function(t,e){var n=this.key||s(t,e);return this.key=i(n,t),this.key},h.create=function(t){return h.bind(new o,n(t))},h}();const s=i.create({length:6,template:"%arg[0]%-%qinu%"}),e=function(){if(!window.DOMParser)return!1;try{(new DOMParser).parseFromString("x","text/html")}catch(t){return!1}return!0}();function n(t){if(e){const i=(new DOMParser).parseFromString(t,"text/html");return i.body.firstElementChild instanceof Element?i.body.firstElementChild:i.body}const i=document.createElement("div");return i.innerHTML=t,i.firstElementChild instanceof Element?i.firstElementChild:i}function o(t,i){let s=t.nextElementSibling;for(;s;){if(i(s))return s;s=s.nextElementSibling}return s}function h(t,i,s){var e;return!(!t||!t.hasAttribute(i))&&(!(null==s?void 0:s.aria)&&!i.toLowerCase().startsWith("aria-")||"true"===(null===(e=t.getAttribute(i))||void 0===e?void 0:e.toLowerCase()))}const r=t=>s(`${t}-item`),a={canSelect:!0,cursorTimeout:150,filterRegex:t=>new RegExp(`\\b(${t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"i"),groupHeaderTemplate:t=>t.label||"",itemTemplate:t=>t.searchRegex&&t.label&&!t.empty?t.label.replace(t.searchRegex,"<mark>$&</mark>"):t.creating?`Press enter to create <mark>${t.searchString}</mark>`:t.empty?t.searchString||t.label?"No Items Found":"No Items":t.label||"",pageSize:10,type:"single"};class l{t(){if(!this.i)return;const t=this.o.querySelector(`#${this.i}`);if(t){const i=this.o.getBoundingClientRect(),{top:s,bottom:e}=t.getBoundingClientRect();(s<i.top||e>i.bottom)&&t.scrollIntoView({behavior:"smooth",block:"nearest"})}}h(t){const i=`<ul class="jt-listbox" role="listbox" id="${this.l}" data-type="${this.u.type}"></ul>`;if(this.o=n(i),Array.isArray(this.u.listClasses)&&this.o.classList.add(...this.u.listClasses),"number"==typeof this.u.tabIndex&&this.o.setAttribute("tabindex",`${this.u.tabIndex}`),t instanceof HTMLElement)for(const i of t.children)if(i instanceof HTMLOptionElement||i instanceof HTMLOptGroupElement){if("placeholder"===i.dataset.role)continue;this.add(i)}else 3!==i.nodeType&&console.warn(`Unexpected element ${i.nodeName.toLowerCase()} in <${t.nodeName.toLowerCase()}>`);else Array.isArray(t)?t.forEach((t=>this.add(t))):console.error(`Unexpected type "${typeof t}" provided to _createDom`,t);const s=n(`<li class="jt-listbox__item" id="${this.l}-empty" data-empty="true" aria-hidden="true" hidden="true"></li>`);return this.u.canCreate?s.setAttribute("role","option"):s.setAttribute("role","presentation"),this.p(s),this.o.append(s),this.m(),this.o}v(t,i=!1){const s=t.key?t.key:r(this.l);document.querySelector(`#${s}`)&&!i&&console.error(`An element with key ${s} already exists.`);const{label:e,group:o,disabled:h,data:a}=t;e||console.warn("Label for <optgroup> is empty");const l=n(`\n<li class="jt-listbox__group" id="${s}">\n    <ul role="group" aria-labelledby="${s}-hdr">\n        <li role="presentation" class="jt-listbox__item jt-listbox__item--header" data-label="${e}" id="${s}-hdr"></li>\n    </ul>\n</li>`);Object.keys(a||{}).length&&(l.dataset.itemData=JSON.stringify(a)),Array.isArray(this.u.groupListClasses)&&l.classList.add(...this.u.groupListClasses),h&&l.setAttribute("aria-disabled","true");const c=l.querySelector('ul[role="group"]');if(!c)throw new Error("_createGroup did not render a ul[role=group]");const u=l.querySelector("li[role=presentation]");if(!u)throw new Error("_createGroup did not render a li[role=presentation]");return Array.isArray(this.u.groupHeaderClasses)&&u.classList.add(...this.u.groupHeaderClasses),u.dataset.groupId=s,u.dataset.itemData=JSON.stringify(a),this.p(u),null==o||o.forEach((t=>{t.group?console.error("Nested option groups are not allowed"):c.append(this.g(t))})),l}g(t,i=!1){const s=t.key?t.key:r(this.l);document.querySelector(`#${s}`)&&!i&&console.error(`An element with key ${s} already exists.`);const{label:e,value:o,disabled:h,separator:a,data:l}=t;if(a){const t=n(`<li class="jt-listbox__item" id="${s}" role="separator"></li>`);return Array.isArray(this.u.itemClasses)&&t.classList.add(...this.u.itemClasses),t.dataset.itemData=JSON.stringify(l),this.p(t),t}e||o||console.warn("Neither label nor value was specified for <option>"),this.o.querySelector(`[data-value="${o||e}"]`)&&!i&&console.warn(`An element with value ${o||e} already exists.`);const c=n(`<li class="jt-listbox__item" id="${s}" data-value="${o||e}" data-label="${e||o}" role="option"></li>`);return Object.keys(l||{}).length&&(c.dataset.itemData=JSON.stringify(l)),Array.isArray(this.u.itemClasses)&&c.classList.add(...this.u.itemClasses),l&&l.searchLabel&&(c.dataset.searchLabel=l.searchLabel),h&&c.setAttribute("aria-disabled","true"),this.p(c),c}_(t){this.$=!0,this.j(),this.L(t),this.t(),setTimeout((()=>{this.$=!1}),this.u.cursorTimeout)}k(t){if(!t||!this.T(t))return;this.M=this.M.filter((i=>i!==t));const i=this.o.querySelector(`#${t}`);i&&i.removeAttribute("aria-checked")}O(t){for(const i of t){let t=i.target;if("characterData"===i.type&&(t=i.target.parentElement),!(t instanceof HTMLElement))return;if(t.getAttribute("data-jt-list-box")===this.l){for(const t of i.addedNodes)if(t instanceof HTMLOptGroupElement||t instanceof HTMLOptionElement){const i=o(t,(t=>t instanceof HTMLElement&&t.hasAttribute("data-key")));i instanceof HTMLElement?this.add(t,i.dataset.key):this.add(t,null)}for(const t of i.removedNodes)t instanceof HTMLElement&&t.hasAttribute("data-key")&&this.remove(t.dataset.key)}else if(i.target instanceof HTMLOptionElement||i.target instanceof HTMLOptGroupElement){const s=t.getAttribute("data-key");if(!s)continue;const e=this.o.querySelector(`#${s}`);if(!e)continue;const n=this.H(i.target,!1),o=i.target instanceof HTMLOptGroupElement?this.v(n,!0):this.g(n,!0);this.o.replaceChild(o,e),o.id=s}}}H(i,s=!0){var e;const n=i.disabled,o=i.dataset.key?i.dataset.key:r(this.l);if(s&&this.A&&(i.dataset.key=o,this.A.observe(i,{attributes:!0,characterData:"OPTION"===i.nodeName,childList:"OPTGROUP"===i.nodeName,subtree:!1})),i instanceof HTMLOptGroupElement){return{key:o,label:i.dataset.label?i.dataset.label:i.label.trim(),group:Array.from(i.querySelectorAll("option")).map((t=>this.H(t,s))).filter((t=>null!==t)),disabled:n,data:i.dataset}}if("separator"===i.dataset.role){const s=(i=>t(i,["label","role"]))(i.dataset);return{key:o,disabled:n,separator:!0,data:s}}{const s=i.value,r=i.dataset.label?i.dataset.label:i.label?i.label:(null===(e=i.textContent)||void 0===e?void 0:e.trim())||"",a=(i=>t(i,["label","role"])||{})(i.dataset);return{key:o,label:r||s,value:s||r,disabled:n,selected:h(i,"selected"),data:a}}}I(t){return"option"===t.getAttribute("role")&&!h(t,"aria-disabled")}T(t){return-1!==this.M.indexOf(t)}S(t){const i=this.o.querySelector(`#${t}`);if(i instanceof HTMLElement)return i.dataset.label}D(t){const i=t.target;if(i&&i instanceof HTMLElement&&this.I(i)){const s=new CustomEvent("item:click",{bubbles:!0,detail:{mouseEvent:t,value:i.dataset.value}});this.o.dispatchEvent(s)}}F(t){const i=t.target;i&&i instanceof HTMLElement&&this.I(i)&&!this.$&&(this.L(),this.j(i.id))}C(t){const i=t.target;i&&i instanceof HTMLElement&&i.matches(".jt-hover")&&!this.$&&(this.L(),this.j())}p(t){var i;let s;const e={key:t.id||"",value:t.dataset.value,label:t.dataset.label,groupLabel:t.dataset.groupLabel,searchRegex:this.P||void 0,searchString:this.N||void 0,type:this.u.type||"single",data:{}};try{e.data=JSON.parse(t.dataset.itemData||"{}")}catch(t){}const n=null===(i=t.getAttribute("role"))||void 0===i?void 0:i.toLowerCase();"option"===n?(e.disabled=h(t,"aria-disabled"),e.focused=this.i===t.id,s=this.u.itemTemplate):"separator"===n?(e.separator=!0,s=this.u.itemTemplate):"true"===t.dataset.empty?(e.creating=this.u.canCreate,e.empty=!0,s=this.u.itemTemplate):"presentation"===n&&(s=this.u.groupHeaderTemplate),s?t.innerHTML=s(e):t.textContent=e.label||""}R(t){if(t&&!this.T(t))if("multiple"===this.u.type){const i=this.o.querySelector(`#${t}`);i instanceof HTMLElement&&(this.M.push(t),i.setAttribute("aria-checked","true"))}else if("single"===this.u.type)if(this.o.querySelectorAll("[role=option]").forEach((t=>{t.removeAttribute("aria-checked"),t.removeAttribute("aria-selected")})),null===t)this.M=[];else{const i=this.o.querySelector(`#${t}`);i&&(this.M=[t],i.setAttribute("aria-selected","true"))}}L(t){const i=this.o.querySelector(".jt-focused"),s=t?this.o.querySelector(`#${t}`):null;t&&i&&i.id===t||(i&&(i.dispatchEvent(new FocusEvent("item:focusout",{bubbles:!0,relatedTarget:s})),i.classList.remove("jt-focused"),this.i="",this.p(i)),s instanceof HTMLElement&&this.I(s)&&(s.classList.add("jt-focused"),s.dispatchEvent(new FocusEvent("item:focusin",{bubbles:!0,relatedTarget:i})),this.i=t,this.p(s)))}j(t){const i=this.o.querySelector(".jt-hover"),s=t?this.o.querySelector(`#${t}`):null;t&&i&&i.id===t||(i&&(i.classList.remove("jt-hover"),this.U="",this.p(i)),s instanceof HTMLElement&&this.I(s)&&(s.classList.add("jt-hover"),this.U=t,this.p(s)))}m(){let t=!1;this.o.querySelectorAll("[role=option]").forEach((i=>{if(!(i instanceof HTMLElement))return;const s=i.dataset.searchLabel?i.dataset.searchLabel:i.dataset.label;s&&this.N&&null===s.match(this.P)?(i.setAttribute("aria-hidden","true"),i.setAttribute("hidden","true")):(i.removeAttribute("aria-hidden"),i.removeAttribute("hidden"),t=!0),this.p(i)}));const i=t=>"option"===t.getAttribute("role")&&!h(t,"hidden")&&!h(t,"aria-hidden");this.o.querySelectorAll("[role=separator]").forEach((function(t){o(t,i)&&function(t,i){let s=t.previousElementSibling;for(;s;){if(i(s))return s;s=s.previousElementSibling}return s}(t,i)?(t.removeAttribute("aria-hidden"),t.removeAttribute("hidden")):(t.setAttribute("aria-hidden","true"),t.setAttribute("hidden","true"))})),this.o.querySelectorAll("[role=presentation]").forEach((function(t){const s=t.closest(".jt-listbox__group");s&&(o(t,i)?(s.removeAttribute("aria-hidden"),s.removeAttribute("hidden")):(s.setAttribute("aria-hidden","true"),s.setAttribute("hidden","true")))}));const s=this.o.querySelector(`#${this.l}-empty`);s instanceof HTMLElement&&(t?(s.setAttribute("aria-hidden","true"),s.setAttribute("hidden","true")):(s.removeAttribute("aria-hidden"),s.removeAttribute("hidden")),this.p(s))}G(t){const i=this.o.querySelector(`#${t}`);if(i instanceof HTMLElement)return i.dataset.value}J(){return this.o?Array.from(this.o.querySelectorAll("[role=option]")).filter((t=>!h(t,"aria-hidden")&&!h(t,"aria-disabled"))).filter((t=>!this.u.hideSelected||!this.T(t.id))).map((t=>t.id)):[]}add(t,i){let s,e=null;if("number"==typeof i){const t=Array.from(this.o.querySelectorAll("[role=option]"));i>0&&i<t.length&&(e=t[i])}else"string"==typeof i&&(e=this.o.querySelector(`#${i}`));const n=t instanceof HTMLElement?this.H(t):"object"==typeof t?t:{label:t};return n?(s=n.group?this.v(n):this.g(n),s?(e?e.insertAdjacentElement("beforebegin",s):this.o.append(s),n.selected&&("multiple"!==this.u.type&&""!==this.value&&console.warn(`Multiple selected options provided to ${this.l}`),this.R(s.id)),s):null):null}clear(){this.M=[],this.o.querySelectorAll("[role=option]").forEach((t=>{t.removeAttribute("aria-checked"),t.removeAttribute("aria-selected")}))}deselect(t){this.o.querySelectorAll(`[data-value="${t}"]`).forEach((t=>this.k(t.id)))}disconnect(){this.A&&this.A.disconnect();const t=document.querySelector(`[data-jt-list-box="${this.l}"]`);t&&t.removeAttribute("data-jt-list-box"),document.querySelectorAll(`option[data-key^="${this.l}"]`).forEach((t=>t.removeAttribute("data-key")))}focusClear(){this.j(),this.L()}focusDown(){const t=this.J(),i=t.indexOf(this.i||this.U);i<t.length-1&&this._(t[i+1])}focusEnd(){const t=this.J();t.length>0&&this._(t[t.length-1])}focusHome(){const t=this.J();t.length>0&&this._(t[0])}focusPageDown(){const t=this.J(),i=t.indexOf(this.i||this.U);if(t.length>0){const s=Math.min(i+(this.u.pageSize||10),t.length-1);this._(t[s])}}focusPageUp(){const t=this.J(),i=-1===t.indexOf(this.i||this.U)?t.length:t.indexOf(this.i||this.U);if(t.length>0){const s=Math.max(i-(this.u.pageSize||10),0);this._(t[s])}}focusSelected(){0===this.M.length?this.focusHome():this._(this.M[0])}focusTypeahead(t){if(!t)return;const i=t.toLowerCase(),s=this.J().map((t=>{var i;return[t,null===(i=this.S(t))||void 0===i?void 0:i.toLowerCase()]})).filter((t=>"string"==typeof t[1]&&t[1].startsWith(i)));if(!s.length)return void this.L();const e=s.findIndex((([t,i])=>t===this.i));e>=s.length-1?this._(s[0][0]):this._(s[e+1][0])}focusUp(){const t=this.J(),i=t.indexOf(this.i||this.U);-1===i?this._(t[t.length-1]):i>0&&this._(t[i-1])}focusValue(t){const i=this.o.querySelector(`[data-value="${t}"]`);return!!(i&&i instanceof HTMLElement&&this.I(i))&&(this._(i.id),!0)}remove(t){let i=null;if("number"==typeof t){const s=Array.from(this.o.querySelectorAll("[role=option]"));t>0&&t<s.length&&(i=s[t])}else"string"==typeof t&&(i=this.o.querySelector(`#${t}`));i&&this.o.removeChild(i)}select(t){this.o.querySelectorAll(`[data-value="${t}"]`).forEach((t=>this.R(t.id)))}toggle(t){this.o.querySelectorAll(`[data-value="${t}"]`).forEach((t=>this.T(t.id)?this.k(t.id):this.R(t.id)))}get displayText(){const t=this.M.map((t=>this.S(t))).filter((t=>!!t));return"multiple"===this.u.type?t:"single"===this.u.type&&t.length?t[0]:""}get empty(){return 0===this.J().length}get filter(){return this.N}set filter(t){this.N=t,this.N?this.u.filterRegex?this.P=this.u.filterRegex(t):this.P=new RegExp(`\\b(${t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"i"):this.P=null,this.m()}get focusedId(){return this.i||this.U}get focusedValue(){if(!this.i||this.U)return"";const t=this.o.querySelector(`#${this.i||this.U}`);return t&&t.dataset.value?t.dataset.value:""}get root(){return this.o}get value(){const t=this.M.map((t=>this.G(t))).filter((t=>!!t));return"multiple"===this.u.type?t:"single"===this.u.type&&t.length?t[0]:""}set value(t){if(this.clear(),"multiple"===this.u.type)Array.isArray(t)?t.forEach((t=>{this.select(t)})):this.select(t);else if("single"===this.u.type){if(Array.isArray(t))throw new Error("Cannot select multiple items");this.select(t)}}constructor(t,i,s){this.q=!1,this.$=!1,this.N="",this.i="",this.U="",this.l="",this.P=null,this.M=[],this.l=t,this.u=Object.assign({},a,s||{}),this.A=new MutationObserver((t=>this.O(t))),i instanceof HTMLElement&&(i.dataset.jtListBox=this.l,this.A.observe(i,{childList:!0})),this.o=this.h(i),this.o.addEventListener("click",(t=>this.D(t)),{capture:!0}),this.o.addEventListener("pointerenter",(t=>this.F(t)),{capture:!0}),this.o.addEventListener("pointerleave",(t=>this.C(t)),{capture:!0})}}const c=["text","search","url","tel","email"];class u extends HTMLElement{get disabled(){var t;return!!(null===(t=this.B)||void 0===t?void 0:t.disabled)}set disabled(t){t?(this.setAttribute("aria-disabled","true"),this.setAttribute("disabled","")):(this.removeAttribute("aria-disabled"),this.removeAttribute("disabled")),this.V.disabled=t,this.K&&(this.K.disabled=t),this.B.disabled!=t&&(this.B.disabled=t)}get open(){return h(this.B,"aria-expanded")}set open(t){t&&!this.disabled?this.W():this.X()}get readOnly(){return this.B.readOnly}set readOnly(t){t?(this.setAttribute("aria-readonly","true"),this.setAttribute("readonly","")):(this.removeAttribute("aria-readonly"),this.removeAttribute("readonly")),this.B.readOnly!=t&&(this.B.readOnly=t)}Y(){if(!this.Z&&this.tt)if("#"==this.tt[0]){const t=document.querySelector(this.tt);t instanceof HTMLElement&&this.it(t)}else fetch(this.tt).then((t=>t.json())).then((t=>this.it(t))).catch((t=>{throw new Error(t)}))}X(){this.classList.remove("jt-open"),this.B.setAttribute("aria-expanded","false"),this.V.setAttribute("aria-expanded","false"),this.st.focusClear(),this.st.filter=""}et(t){for(const i of t)switch(i.attributeName){case"disabled":this.disabled=this.B.disabled;break;case"readonly":this.readOnly=this.B.readOnly;break;case"list":if(this.B.hasAttribute("list")){this.X(),this.Z=!1,this.tt=`#${this.B.getAttribute("list")}`,this.B.removeAttribute("list");break}}}nt(){this.ot=!1,this.ht=!1,this.B.parentElement.classList.remove("jt-focus"),this.st.root.classList.remove("jt-focus")}rt(){this.ot=!0,this.ht=!1,this.B.parentElement.classList.remove("jt-focus"),this.st.root.classList.add("jt-focus")}lt(){this.ot=!1,this.ht=!0,this.B.parentElement.classList.add("jt-focus"),this.st.root.classList.remove("jt-focus")}ct(){return{}}D(){this.disabled||this.readOnly||(this.open=!this.open)}ut(t){const i=t.target;i instanceof HTMLElement&&null===i.closest(`#${this.l}`)&&this.X()}dt(){this.lt()}ft(){this.nt()}bt(t){this.readOnly||this.yt(t.detail.value),this.X()}vt(t){this.B.setAttribute("aria-activedescendant",t.target instanceof HTMLElement&&t.target.id||"")}gt(t){t.relatedTarget instanceof HTMLElement?this.B.setAttribute("aria-activedescendant",t.relatedTarget.id||""):this.B.setAttribute("aria-activedescendant","")}_t(t){let i=!1;const s=this.ot;switch(t.key){case"Enter":this.ot&&this.st.focusedId&&(this.yt(this.st.focusedValue),this.X(),this.lt(),i=!0);break;case"Esc":case"Escape":this.open?(this.X(),this.lt()):this.yt(""),i=!0;break;case"ArrowDown":case"Down":this.W(),this.rt(),t.altKey||this.st.focusedId&&!s||this.st.focusDown(),i=!0;break;case"ArrowUp":case"Up":this.st.empty||(this.W(),this.rt(),t.altKey||this.st.focusedId&&!s||this.st.focusUp()),i=!0;break;case"Tab":""!==this.st.focusedId&&this.yt(this.st.focusedValue),this.X()}i&&(t.stopPropagation(),t.preventDefault())}$t(t){let i=!1;if(1===t.key.length&&t.key.match(/\S| /))this.st.filter=this.B.value;else if("Escape"===t.key||"Esc"===t.key||"Enter"==t.key)return;switch(t.key){case"Backspace":this.lt(),this.st.focusClear(),this.st.filter=this.B.value,i=!0;break;case"Left":case"ArrowLeft":case"Right":case"ArrowRight":case"Home":case"End":this.lt(),this.st.focusClear(),i=!0;break;default:this.st.empty||(this.open||this.W(),this.st.focusValue(this.st.filter)),i=!0}i&&(t.stopPropagation(),t.preventDefault())}Et(){this.disabled||(this.open=!this.open)}W(){this.Y(),this.open||(this.classList.add("jt-open"),this.B.setAttribute("aria-expanded","true"),this.V.setAttribute("aria-expanded","true"),this.readOnly||this.st.focusValue(this.B.value),document.activeElement!==this.B&&this.B.focus())}it(t){const i=new l(`${this.l}-listbox`,t,this.ct());this.st.root.replaceWith(i.root),this.st=i,this.Z=!0,this.st.root.addEventListener("item:click",(t=>this.bt(t))),this.st.root.addEventListener("item:focusin",(t=>this.vt(t))),this.st.root.addEventListener("item:focusout",(t=>this.gt(t)))}yt(t){this.readOnly||(this.st.filter=t,this.B.value=t,this.B.setSelectionRange(t.length,t.length),this.B.dispatchEvent(new Event("input")))}clear(){this.yt(""),requestAnimationFrame((()=>{this.B.focus()}))}constructor(){if(super(),this.l=this.getAttribute("id")||s("jt-autocomplete"),this.hasAttribute("id")||this.setAttribute("id",this.l),this.B=this.querySelector("input"),!this.B)return;if(!c.includes(this.B.type||"text"))throw new Error(`JtAutocomplete does not support <input type='${this.B.type}'>`);this.B.setAttribute("autocomplete","off--jt-controls"),this.B.setAttribute("role","combobox"),this.B.setAttribute("aria-autocomplete","list"),this.B.addEventListener("click",(()=>this.D())),this.B.addEventListener("focusin",(()=>this.dt())),this.B.addEventListener("focusout",(()=>this.ft())),this.B.addEventListener("keydown",(t=>this._t(t))),this.B.addEventListener("keyup",(t=>this.$t(t))),this.wt=n(`<button type='button' data-action='close' id="${this.l}-close" tabindex="-1"><span class='jt-sr-only'>Close Suggestion List</span></button>`),this.wt.addEventListener("click",(()=>this.X())),this.V=n(`<button type='button' data-action='open' id='${this.l}-open' tabindex="-1"><span class='jt-sr-only'>Show Suggestions<span></button>`),this.V.addEventListener("click",(()=>this.Et()));const t=document.createElement("div");t.classList.add("jt-control__buttons"),t.appendChild(this.V),h(this,"clearable")&&(this.K=n(`<button type='button' data-action='clear' id='${this.l}-clear' tabindex="-1"><span class='jt-sr-only'>Clear Input</span></button>`),this.K.addEventListener("click",(()=>this.clear())),t.appendChild(this.K));const i=document.createElement("div");i.classList.add("jt-control"),i.appendChild(this.wt),i.appendChild(this.B),i.appendChild(t),this.appendChild(i),this.Z=!1,this.hasAttribute("src")?this.tt=this.getAttribute("src"):this.hasAttribute("list")?this.tt=`#${this.getAttribute("list")}`:this.tt=`#${this.B.getAttribute("list")}`,this.st=new l(`${this.l}-listbox`,[],this.ct());const e=document.createElement("div");e.classList.add("jt-popup"),e.appendChild(this.st.root),this.appendChild(e),this.open=!1,this.disabled=this.B.disabled,this.readOnly=this.B.readOnly,this.classList.toggle("jt-placeholder-shown",""==this.B.value),this.B.addEventListener("input",(()=>{this.classList.toggle("jt-placeholder-shown",""==this.B.value)})),this.A=new MutationObserver((t=>this.et(t))),this.A.observe(this.B,{attributes:!0}),document.addEventListener("click",(t=>this.ut(t)))}static register(){customElements.define("jt-autocomplete",u)}}"boolean"==typeof __ROLLUP_IIFE&&__ROLLUP_IIFE&&u.register();export{u as default};
